!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AppPotSDK=e():t.AppPotSDK=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){if(t){if(v)throw"AppPot is already configured";v=new _(t)}return v}var o=n(1),i=n(2),s=n(4),u=n(12),a=n(16),c=n(18),p=n(20),l=n(21),f=n(22),h=n(23),d=n(24),m=n(17),y=n(11),g=n(13),_=function(){function t(t){if(this._lock=[],!t)return this._inst;this._inst=this,this._config=new o.Config(t),this._authInfo=new i.AuthInfo(this),this._ajax=new s.Ajax(this._config,this._authInfo),this._isOnline=!0;var e={LocalAuthenticator:u.LocalAuthenticator};for(var n in e)this[n]=new e[n](this,this._config,this._authInfo);this.User=l.getUserClass(this),this.Model=c.Model,this.Device=p.default,this.Role=l.Role,this.File=h.getFileClass(this),this.GroupsRoles=l.GroupsRoles,this.DataType=m.DataType,this.Error=y.Error,this.Group=f.getGroupClass(this),this.Gateway=d.getGateway(this)}return t.prototype.uuid=function(){for(var t="",e=0;e<32;e++){var n=16*Math.random()|0;8!=e&&12!=e&&16!=e&&20!=e||(t+="-"),t+=(12==e?4:16==e?3&n|8:n).toString(16)}return t},t.prototype.isLocked=function(t){return this._lock[t]},t.prototype.lock=function(t){this._lock[t]=!0},t.prototype.unlock=function(t){this._lock[t]=!1},t.prototype.getAjax=function(){return this._ajax},t.prototype.getConfig=function(){return this._config},t.prototype.getAuthInfo=function(){return this._authInfo},t.prototype.getUser=function(){return this._authInfo.getUser()},t.prototype.defineModel=function(t,e){return c.Model.define(this,t,e)},t.prototype.createDatabase=function(t){return a.Database.createDatabase(this,t)},t.prototype.dropAndCreateDatabase=function(t){return a.Database.dropAndCreateDatabase(this,t)},t.prototype.setLocalDatabase=function(t){this._localDb=t},t.prototype.getLocalDatabase=function(){return this._localDb},t.prototype.getBuildDate=function(){return 1504676687},t.prototype.getVersion=function(){return["2","3","28"].join(".")||"unknown"},t.prototype.log=function(t,e){var n=this;return void 0===e&&(e="MONITOR"),this._authInfo.hasToken()?new g.Promise(function(r,o){n._ajax.post("logs").send({message:t,logLevel:e}).end(s.Ajax.end(r,o))}):g.Promise.reject("not logined")},t.prototype.sendPushNotification=function(t,e,n){var r=this;if(!this._authInfo.hasToken())return g.Promise.reject("not logined");var o=e instanceof Array?e:[e],i={message:t,target:o};return n&&(i.title=n),new g.Promise(function(t,e){r._ajax.post("messages").send(i).end(s.Ajax.end(t,e))})},t.prototype.isOnline=function(){return this._isOnline},t.prototype.online=function(t){this._isOnline=t},t.prototype.sendMail=function(t,e,n,r,o,i,u){var a=this;return this._authInfo.hasToken()?n instanceof Array&&r instanceof Array&&o instanceof Array?0==n.length&&0==r.length&&0==o.length?g.Promise.reject("destination address is not specified"):new g.Promise(function(c,p){a._ajax.post("emails").send({mailFrom:e,mailTo:n,mailCc:r,mailBcc:o,sendingRouteName:t,subject:i,body:u}).end(s.Ajax.end(c,p))}):g.Promise.reject("mailTo, mailCc, mailBcc must be array"):g.Promise.reject("not logined")},t}();e.AppPot=_;var v=null;e.getService=r},function(t,e){"use strict";var n=function(){function t(t){this.props=t;var e=this.props.url;"/"!=e.charAt(e.length-1)&&(this.props.url+="/"),this.props.deviceUDID="apppotsdkjs"}return Object.defineProperty(t.prototype,"entryPoint",{get:function(){return this.props.url+"api/"+this.props.companyId+"/"+this.props.appId+"/"+this.props.appVersion+"/"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeout",{get:function(){return this.props.timeout||1e4},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this.props.url},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appId",{get:function(){return this.props.appId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appKey",{get:function(){return this.props.appKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appVersion",{get:function(){return this.props.appVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deviceUDID",{get:function(){return this.props.deviceUDID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"companyId",{get:function(){return this.props.companyId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupId",{get:function(){return this.props.groupId},enumerable:!0,configurable:!0}),t}();e.Config=n},function(t,e,n){"use strict";var r=(n(3),function(){function t(t){this._token="",this.apppot=t}return t.prototype.hasToken=function(){return""!==this._token},t.prototype.getToken=function(){return this._token},t.prototype.getUser=function(){return this._user},t.prototype.setUser=function(t){this._user=t},t.prototype.setToken=function(t){this._token=t},t.prototype.clearUser=function(){this._user=null},t.prototype.clearToken=function(){this._token=""},t.prototype.serialize=function(){var t={};return t.token=this._token,t.user=this._user._columns,JSON.stringify(t)},t.prototype.deserialize=function(t){var e=JSON.parse(t);if(e){this.setToken(e.token);var n=new this.apppot.User(e.user);return this.setUser(n),!0}return!1},t}());e.AuthInfo=r},function(t,e){/*
	object-assign
	(c) Sindre Sorhus
	@license MIT
	*/
"use strict";function n(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function r(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"!==r.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(t){o[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}}var o=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;t.exports=r()?Object.assign:function(t,e){for(var r,u,a=n(t),c=1;c<arguments.length;c++){r=Object(arguments[c]);for(var p in r)i.call(r,p)&&(a[p]=r[p]);if(o){u=o(r);for(var l=0;l<u.length;l++)s.call(r,u[l])&&(a[u[l]]=r[u[l]])}}return a}},function(t,e,n){"use strict";var r=n(5),o=n(11),i=n(3),s=function(){function t(t,e){this._config=t,this._authInfo=e}return t.prototype.setToken=function(t){if(this._authInfo.hasToken()){var e=t.set("apppot-token",this._authInfo.getToken());return e}return t},t.prototype.buildOpts=function(t){return i({entryPoint:this._config.entryPoint,timeout:this._config.timeout,contentType:"application/json"},t)},t.prototype.get=function(t,e){var n=this.buildOpts(e),o=r.get(n.entryPoint+t).timeout(n.timeout);return this.setToken(o)},t.prototype.post=function(t,e){var n=this.buildOpts(e),o=r.post(n.entryPoint+t).timeout(n.timeout);return"no-set"!=n.contentType&&o.set("Content-Type",n.contentType),this.setToken(o)},t.prototype.update=function(t,e){return this.put(t,e)},t.prototype.put=function(t,e){var n=this.buildOpts(e),o=r.put(n.entryPoint+t).timeout(n.timeout);return"no-set"!=n.contentType&&o.set("Content-Type",n.contentType),this.setToken(o)},t.prototype.remove=function(t,e){var n=this.buildOpts(e),o=r.del(n.entryPoint+t).timeout(n.timeout);return"no-set"!=n.contentType&&o.set("Content-Type",n.contentType),this.setToken(o)},t.end=function(t,e,n,r){return function(i,s){if(i){var u={status:"error",results:i,response:s};r?r(u):e(u)}else{if(s.type.match("octet-stream"))return void t(s.text);var u=JSON.parse(s.text);u.hasOwnProperty("status")&&"error"==u.status?r?r(new o.Error(u.errCode,u.description)):e(new o.Error(u.errCode,u.description)):n?n(u):t(u)}}},t}();e.Ajax=s},function(t,e,n){function r(){}function o(t){var e={}.toString.call(t);switch(e){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function i(t){if(!v(t))return t;var e=[];for(var n in t)null!=t[n]&&s(e,n,t[n]);return e.join("&")}function s(t,e,n){return Array.isArray(n)?n.forEach(function(n){s(t,e,n)}):void t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}function u(t){for(var e,n,r={},o=t.split("&"),i=0,s=o.length;i<s;++i)n=o[i],e=n.split("="),r[decodeURIComponent(e[0])]=decodeURIComponent(e[1]);return r}function a(t){var e,n,r,o,i=t.split(/\r?\n/),s={};i.pop();for(var u=0,a=i.length;u<a;++u)n=i[u],e=n.indexOf(":"),r=n.slice(0,e).toLowerCase(),o=j(n.slice(e+1)),s[r]=o;return s}function c(t){return/[\/+]json\b/.test(t)}function p(t){return t.split(/ *; */).shift()}function l(t){return g(t.split(/ *; */),function(t,e){var n=e.split(/ *= */),r=n.shift(),o=n.shift();return r&&o&&(t[r]=o),t},{})}function f(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this.setStatusProperties(this.xhr.status),this.header=this.headers=a(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text?this.text:this.xhr.response):null}function h(t,e){var n=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t=null,e=null;try{e=new f(n)}catch(e){return t=new Error("Parser is unable to parse the response"),t.parse=!0,t.original=e,t.rawResponse=n.xhr&&n.xhr.responseText?n.xhr.responseText:null,t.statusCode=n.xhr&&n.xhr.status?n.xhr.status:null,n.callback(t)}if(n.emit("response",e),t)return n.callback(t,e);if(e.status>=200&&e.status<300)return n.callback(t,e);var r=new Error(e.statusText||"Unsuccessful HTTP response");r.original=t,r.response=e,r.status=e.status,n.callback(r,e)})}function d(t,e){var n=b("DELETE",t);return e&&n.end(e),n}var m,y=n(6),g=n(7),_=n(8),v=n(9);m="undefined"!=typeof window?window:"undefined"!=typeof self?self:this;var b=t.exports=n(10).bind(null,h);b.getXHR=function(){if(!(!m.XMLHttpRequest||m.location&&"file:"==m.location.protocol&&m.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1};var j="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};b.serializeObject=i,b.parseString=u,b.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},b.serialize={"application/x-www-form-urlencoded":i,"application/json":JSON.stringify},b.parse={"application/x-www-form-urlencoded":u,"application/json":JSON.parse},f.prototype.get=function(t){return this.header[t.toLowerCase()]},f.prototype.setHeaderProperties=function(t){var e=this.header["content-type"]||"";this.type=p(e);var n=l(e);for(var r in n)this[r]=n[r]},f.prototype.parseBody=function(t){var e=b.parse[this.type];return!e&&c(this.type)&&(e=b.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null},f.prototype.setStatusProperties=function(t){1223===t&&(t=204);var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},f.prototype.toError=function(){var t=this.req,e=t.method,n=t.url,r="cannot "+e+" "+n+" ("+this.status+")",o=new Error(r);return o.status=this.status,o.method=e,o.url=n,o},b.Response=f,y(h.prototype);for(var w in _)h.prototype[w]=_[w];h.prototype.abort=function(){if(!this.aborted)return this.aborted=!0,this.xhr&&this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this},h.prototype.type=function(t){return this.set("Content-Type",b.types[t]||t),this},h.prototype.responseType=function(t){return this._responseType=t,this},h.prototype.accept=function(t){return this.set("Accept",b.types[t]||t),this},h.prototype.auth=function(t,e,n){switch(n||(n={type:"basic"}),n.type){case"basic":var r=btoa(t+":"+e);this.set("Authorization","Basic "+r);break;case"auto":this.username=t,this.password=e}return this},h.prototype.query=function(t){return"string"!=typeof t&&(t=i(t)),t&&this._query.push(t),this},h.prototype.attach=function(t,e,n){return this._getFormData().append(t,e,n||e.name),this},h.prototype._getFormData=function(){return this._formData||(this._formData=new m.FormData),this._formData},h.prototype.send=function(t){var e=v(t),n=this._header["content-type"];if(e&&v(this._data))for(var r in t)this._data[r]=t[r];else"string"==typeof t?(n||this.type("form"),n=this._header["content-type"],"application/x-www-form-urlencoded"==n?this._data=this._data?this._data+"&"+t:t:this._data=(this._data||"")+t):this._data=t;return!e||o(t)?this:(n||this.type("json"),this)},f.prototype.parse=function(t){return m.console,this.serialize(t),this},f.prototype.serialize=function(t){return this._parser=t,this},h.prototype.callback=function(t,e){var n=this._callback;this.clearTimeout(),n(t,e)},h.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},h.prototype.timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},h.prototype.withCredentials=function(){return this._withCredentials=!0,this},h.prototype.end=function(t){var e=this,n=this.xhr=b.getXHR(),i=this._query.join("&"),s=this._timeout,u=this._formData||this._data;this._callback=t||r,n.onreadystatechange=function(){if(4==n.readyState){var t;try{t=n.status}catch(e){t=0}if(0==t){if(e.timedout)return e.timeoutError();if(e.aborted)return;return e.crossDomainError()}e.emit("end")}};var a=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),t.direction="download",e.emit("progress",t)};this.hasListeners("progress")&&(n.onprogress=a);try{n.upload&&this.hasListeners("progress")&&(n.upload.onprogress=a)}catch(t){}if(s&&!this._timer&&(this._timer=setTimeout(function(){e.timedout=!0,e.abort()},s)),i&&(i=b.serializeObject(i),this.url+=~this.url.indexOf("?")?"&"+i:"?"+i),this.username&&this.password?n.open(this.method,this.url,!0,this.username,this.password):n.open(this.method,this.url,!0),this._withCredentials&&(n.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof u&&!o(u)){var p=this._header["content-type"],l=this._parser||b.serialize[p?p.split(";")[0]:""];!l&&c(p)&&(l=b.serialize["application/json"]),l&&(u=l(u))}for(var f in this.header)null!=this.header[f]&&n.setRequestHeader(f,this.header[f]);return this._responseType&&(n.responseType=this._responseType),this.emit("request",this),n.send("undefined"!=typeof u?u:null),this},b.Request=h,b.get=function(t,e,n){var r=b("GET",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},b.head=function(t,e,n){var r=b("HEAD",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},b.del=d,b.delete=d,b.patch=function(t,e,n){var r=b("PATCH",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},b.post=function(t,e,n){var r=b("POST",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},b.put=function(t,e,n){var r=b("PUT",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}},function(t,e,n){function r(t){if(t)return o(t)}function o(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===e||r.fn===e){n.splice(o,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n){n=n.slice(0);for(var r=0,o=n.length;r<o;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e){t.exports=function(t,e,n){for(var r=0,o=t.length,i=3==arguments.length?n:t[r++];r<o;)i=e.call(null,i,t[r],++r,t);return i}},function(t,e,n){var r=n(9);e.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},e.parse=function(t){return this._parser=t,this},e.timeout=function(t){return this._timeout=t,this},e.then=function(t,e){return this.end(function(n,r){n?e(n):t(r)})},e.use=function(t){return t(this),this},e.get=function(t){return this._header[t.toLowerCase()]},e.getHeader=e.get,e.set=function(t,e){if(r(t)){for(var n in t)this.set(n,t[n]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},e.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},e.field=function(t,e){return this._getFormData().append(t,e),this}},function(t,e){function n(t){return null!=t&&"object"==typeof t}t.exports=n},function(t,e){function n(t,e,n){return"function"==typeof n?new t("GET",e).end(n):2==arguments.length?new t("GET",e):new t(e,n)}t.exports=n},function(t,e){"use strict";var n=function(){function t(t,e){this._code=t,this._description=e}return Object.defineProperty(t.prototype,"code",{get:function(){return this._code},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._description},enumerable:!0,configurable:!0}),t}();e.Error=n},function(t,e,n){"use strict";var r=n(4),o=n(13),i=n(3),s=function(){function t(t){var e=this;this.login=function(t,n,r,o){return e.getAnonymousToken(o).then(function(){return!r||!o||e.devices(o)}).then(function(){return e.apiLogin(t,n,r,o)})},this.logout=function(){return e.apiLogout()},this.isLogined=function(){return e._isLogined},this.getAnonymousToken=function(t){return new o.Promise(function(n,o){e._appPot.getAjax().get("anonymousTokens").query("appKey="+e._appPot.getConfig().appKey).query("deviceUDID="+(t&&t.udid||e._appPot.getConfig().deviceUDID)).end(r.Ajax.end(n,o,function(t){e._appPot.getAuthInfo().setToken(t.results),n(t.results)}))})},this._appPot=t}return t.prototype.devices=function(t){var e=this;return new o.Promise(function(n,o){e._appPot.getAjax().post("devices").set("apppot-token",e._appPot.getAuthInfo().getToken()).send({deviceToken:t.token,deviceUDID:t.udid,deviceName:t.name,osType:t.osType}).end(r.Ajax.end(n,o,function(t){n()}))})},t.prototype.apiLogin=function(t,e,n,s){var u=this;return this._appPot.getAuthInfo().clearUser(),new o.Promise(function(o,a){u._appPot.getAjax().post("auth/login").set("apppot-token",u._appPot.getAuthInfo().getToken()).send({username:t,password:e,appId:u._appPot.getConfig().appId,deviceUDID:s?s.udid:u._appPot.getConfig().deviceUDID,isPush:!!n,appVersion:u._appPot.getConfig().appVersion,companyId:u._appPot.getConfig().companyId}).end(r.Ajax.end(function(t){t.authInfor&&(t.authInfo=t.authInfor,delete t.authInfor),u._appPot.getAuthInfo().setToken(t.authInfo.userTokens);var e=new u._appPot.User(i({},t.authInfo,t.authInfo.userInfo));u._appPot.getAuthInfo().setUser(e),u._isLogined=!0,o(u._appPot.getAuthInfo())},function(t){u._isLogined=!1,a(t)}))})},t.prototype.apiLogout=function(){var t=this;return new o.Promise(function(e,n){t._appPot.getAjax().post("auth/logout").set("apppot-token",t._appPot.getAuthInfo().getToken()).send({}).end(r.Ajax.end(function(n){t._appPot.getAuthInfo().clearToken(),t._appPot.getAuthInfo().clearUser(),t._isLogined=!1,e(t._appPot.getAuthInfo())},n))})},t}();e.LocalAuthenticator=s},function(t,e,n){(function(e,r){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   3.3.1
	 */
!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function o(t){return"function"==typeof t}function i(t){K=t}function s(t){$=t}function u(){return function(){return e.nextTick(f)}}function a(){return function(){V(f)}}function c(){var t=0,e=new Z(f),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function p(){var t=new MessageChannel;return t.port1.onmessage=f,function(){return t.port2.postMessage(0)}}function l(){var t=setTimeout;return function(){return t(f,1)}}function f(){for(var t=0;t<J;t+=2){var e=nt[t],n=nt[t+1];e(n),nt[t]=void 0,nt[t+1]=void 0}J=0}function h(){try{var t=n(15);return V=t.runOnLoop||t.runOnContext,a()}catch(t){return l()}}function d(t,e){var n=arguments,r=this,o=new this.constructor(y);void 0===o[ot]&&S(o);var i=r._state;return i?!function(){var t=n[i-1];$(function(){return L(i,o,t,r._result)})}():P(r,o,t,e),o}function m(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(y);return O(n,t),n}function y(){}function g(){return new TypeError("You cannot resolve a promise with itself")}function _(){return new TypeError("A promises callback cannot return that same promise.")}function v(t){try{return t.then}catch(t){return at.error=t,at}}function b(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function j(t,e,n){$(function(t){var r=!1,o=b(n,e,function(n){r||(r=!0,e!==n?O(t,n):I(t,n))},function(e){r||(r=!0,x(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,x(t,o))},t)}function w(t,e){e._state===st?I(t,e._result):e._state===ut?x(t,e._result):P(e,void 0,function(e){return O(t,e)},function(e){return x(t,e)})}function T(t,e,n){e.constructor===t.constructor&&n===d&&e.constructor.resolve===m?w(t,e):n===at?x(t,at.error):void 0===n?I(t,e):o(n)?j(t,e,n):I(t,e)}function O(e,n){e===n?x(e,g()):t(n)?T(e,n,v(n)):I(e,n)}function A(t){t._onerror&&t._onerror(t._result),E(t)}function I(t,e){t._state===it&&(t._result=e,t._state=st,0!==t._subscribers.length&&$(E,t))}function x(t,e){t._state===it&&(t._state=ut,t._result=e,$(A,t))}function P(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+st]=n,o[i+ut]=r,0===i&&t._state&&$(E,t)}function E(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?L(n,r,o,i):o(i);t._subscribers.length=0}}function k(){this.error=null}function N(t,e){try{return t(e)}catch(t){return ct.error=t,ct}}function L(t,e,n,r){var i=o(n),s=void 0,u=void 0,a=void 0,c=void 0;if(i){if(s=N(n,r),s===ct?(c=!0,u=s.error,s=null):a=!0,e===s)return void x(e,_())}else s=r,a=!0;e._state!==it||(i&&a?O(e,s):c?x(e,u):t===st?I(e,s):t===ut&&x(e,s))}function D(t,e){try{e(function(e){O(t,e)},function(e){x(t,e)})}catch(e){x(t,e)}}function C(){return pt++}function S(t){t[ot]=pt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function q(t,e){this._instanceConstructor=t,this.promise=new t(y),this.promise[ot]||S(this.promise),z(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?I(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&I(this.promise,this._result))):x(this.promise,R())}function R(){return new Error("Array Methods must be provided an Array")}function U(t){return new q(this,t).promise}function M(t){var e=this;return new e(z(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function F(t){var e=this,n=new e(y);return x(n,t),n}function B(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function X(t){this[ot]=C(),this._result=this._state=void 0,this._subscribers=[],y!==t&&("function"!=typeof t&&B(),this instanceof X?D(this,t):H())}function G(){var t=void 0;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=X}var Q=void 0;Q=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var z=Q,J=0,V=void 0,K=void 0,$=function(t,e){nt[J]=t,nt[J+1]=e,J+=2,2===J&&(K?K(f):rt())},W="undefined"!=typeof window?window:void 0,Y=W||{},Z=Y.MutationObserver||Y.WebKitMutationObserver,tt="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),et="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,nt=new Array(1e3),rt=void 0;rt=tt?u():Z?c():et?p():void 0===W?h():l();var ot=Math.random().toString(36).substring(16),it=void 0,st=1,ut=2,at=new k,ct=new k,pt=0;return q.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===it&&n<t;n++)this._eachEntry(e[n],n)},q.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===m){var o=v(t);if(o===d&&t._state!==it)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===X){var i=new n(y);T(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},q.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===it&&(this._remaining--,t===ut?x(r,n):this._result[e]=n),0===this._remaining&&I(r,this._result)},q.prototype._willSettleAt=function(t,e){var n=this;P(t,void 0,function(t){return n._settledAt(st,e,t)},function(t){return n._settledAt(ut,e,t)})},X.all=U,X.race=M,X.resolve=m,X.reject=F,X._setScheduler=i,X._setAsap=s,X._asap=$,X.prototype={constructor:X,then:d,catch:function(t){return this.then(null,t)}},G(),X.polyfill=G,X.Promise=X,X})}).call(e,n(14),function(){return this}())},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(p===setTimeout)return setTimeout(t,0);if((p===n||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(e){try{return p.call(null,t,0)}catch(e){return p.call(this,t,0)}}}function i(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function s(){m&&h&&(m=!1,h.length?d=h.concat(d):y=-1,d.length&&u())}function u(){if(!m){var t=o(s);m=!0;for(var e=d.length;e;){for(h=d,d=[];++y<e;)h&&h[y].run();y=-1,e=d.length}h=null,m=!1,i(t)}}function a(t,e){this.fun=t,this.array=e}function c(){}var p,l,f=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:n}catch(t){p=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var h,d=[],m=!1,y=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new a(t,e)),1!==d.length||m||o(u)},a.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e){},function(t,e,n){"use strict";var r=n(17),o=n(4),i=n(13),s=n(11),u=function(){function t(){}return t.dropAndCreateDatabase=function(e,n){return t._createAppData(e,n,!0)},t.createDatabase=function(e,n){return t._createAppData(e,n,!1)},t.createLocalTable=function(e,n){var r=t.getTableDefinition(n),o=(r.table,r.errors);0!=o.length},t._makeDefaultTable=function(t){return{primary_key:"objectId",name:t,columns:[{colName:"objectId",type:"varchar"},{colName:"scopeType",type:"varchar"},{colName:"createTime",type:"long"},{colName:"updateTime",type:"long"}]}},t.mapType2SqliteType=function(t){switch(t){case"varchar":return"TEXT";case"integer":case"long":return"NUMERIC"}},t._buildColumnItem=function(t,e){var n={colName:t,type:r.DataType[e.type].toLowerCase()};switch(n.type){case"varchar":n.fieldLength=e.length;break;case"bool":n.type="varchar",n.fieldLength=1;break;case"datetime":n.type="long";break;case"double":n.type="varchar",n.fieldLength=255}return n},t.getSqliteTableDefinition=function(e){var n=t.getTableDefinition(e),r=n.table,o=n.errors;if(0!=o.length)throw new s.Error(-1,o.join("\n"));var i=r.name,u=r.primary_key,a=r.columns.map(function(e){return e.colName==u?"`"+e.colName+"` "+t.mapType2SqliteType(e.type)+" PRIMARY KEY":"`"+e.colName+"` "+t.mapType2SqliteType(e.type)});return a.push("serverCreateTime TEXT"),a.push("serverUpdateTime TEXT"),["CREATE TABLE IF NOT EXISTS "+i+" ( "+a.join(",")+" );","CREATE TABLE IF NOT EXISTS apppot_"+i+"_queue ( `type` TEXT, `id` TEXT PRIMARY KEY, `serverUpdateTime` TEXT);"]},t.getTableDefinition=function(e){var n=[],r=e.modelColumns,o=e.className;if(!o)throw new s.Error(-1,"table name is Required");var i=t._makeDefaultTable(o);for(var u in r)"objectId"!=u?i.columns.push(t._buildColumnItem(u,r[u])):n.push("invalid column name: "+o+"."+u);return{table:i,errors:n}},t._createAppData=function(e,n,r){var u=[],a=[];for(var c in n)try{var p=t.getTableDefinition(n[c]),l=p.table,f=p.errors;a=a.concat(f),u.push(l)}catch(t){return i.Promise.reject(t)}if(0!=a.length)return i.Promise.reject(new s.Error(-1,a.join("\n")));var h={appId:e.getConfig().appId,appVersion:e.getConfig().appVersion,isResetDatabase:r,companyId:e.getConfig().companyId,tables:u};return new i.Promise(function(t,n){e.getAjax().post("schemas").send(h).end(o.Ajax.end(t,n))})},t}();e.Database=u},function(t,e){"use strict";!function(t){t[t.Varchar=0]="Varchar",t[t.Integer=1]="Integer",t[t.Long=2]="Long",t[t.Bool=3]="Bool",t[t.DateTime=4]="DateTime",t[t.Double=5]="Double"}(e.DataType||(e.DataType={}));e.DataType},function(t,e,n){"use strict";var r,o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(17),s=n(4),u=n(11),a=n(13),c=n(16),p=n(19),l=n(3);!function(t){function e(t,e,n){var r=n?n:d[t];return e?new r(e):new r}function n(t,e,n){return Object.keys(n).forEach(function(t){if(m.indexOf(t)!=-1)throw new u.Error(-1,"Invalid column name: "+t)}),d[e]=function(){function r(t){var e=this;this._columns={},Object.keys(n).forEach(function(t){Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(e){this.set(t,e)},enumerable:!0,configurable:!0})}),t&&this.set(t)}return r._getColumnsPlaceholders=function(t){var n=Object.keys(d[e].filterDefinedColumnOnly({})).map(function(t){return t}),r=n.map(function(t){return"?"});return{colNames:n,placeholders:r}},r._insertAllLocal=function(n){var r=d[e]._normalizeColumns(n),o=r.columns,i=r.models,s=d[e]._getColumnsPlaceholders(),u=s.colNames,l=s.placeholders,f=[],h=o.map(function(n,r){return u.map(function(o){if("objectId"==o&&(null===n[o]||void 0===n[o])){var s=e+"_"+t.uuid();return i[r].set("objectId",s),f[r]=s,s}return n[o]})});return new a.Promise(function(n,r){var o=t.getLocalDatabase();o||r("Local Database is undefined");var s=c.Database.getSqliteTableDefinition(d[e]);o.transaction(function(t){s.forEach(function(e){t.executeSql(e)}),h.forEach(function(n,r){var o=u.map(function(t){return"`"+t+"`"}),i="INSERT INTO "+e+" ( "+o.join(",")+" ) VALUES ( "+l.join(",")+" )";t.executeSql(i,n,function(){var n="INSERT INTO "+p.default.getQueueTableName(e)+" ( `type`, `id`, `serverUpdateTime` ) VALUES ( ?, ?, ? )",o=["created",f[r],null];t.executeSql(n,o)})})},function(t){r(t)},function(){n(i)})})},r._insertAll=function(t){var n=d[e]._normalizeColumns(t),r=n.columns,o=n.models;return d[e]._rawInsert(r).then(function(t){return t.results.forEach(function(t,e){o[e].set(t)}),o})},r.insertAll=function(n){return t.isOnline()?d[e]._insertAll(n):d[e]._insertAllLocal(n)},r._insertLocal=function(t){return d[e]._insertAllLocal([t]).then(function(t){return t[0]})},r._insert=function(t){var n=this;if(t instanceof Array)throw"invalid argument type: use insertAll";var r=[d[e].formatColumns(t,!0)];return d[e]._rawInsert(r).then(function(t){var o=l({},r[0],t.results[0]);return new(n||d[e])(o)})},r.insert=function(n){return t.isOnline()?d[e]._insert(n):d[e]._insertLocal(n)},r._findByIdLocal=function(t){return d[e]._selectLocal().where("objectId = ?",t).findOne().then(function(t){return t[e]?t[e]:a.Promise.reject("not found")})},r._findById=function(n){var r=this,o=function(o,i){t.getAjax().get("data/"+e+"/"+n).end(s.Ajax.end(function(t){var n=new(r||d[e])(t[e][0]);o(n)},i))};return new a.Promise(o)},r.findById=function(n){return t.isOnline()?d[e]._findById(n):d[e]._findByIdLocal(n)},r._findAllLocal=function(){return d[e]._selectLocal().findList()},r._findAll=function(){return d[e].select().findList()},r.findAll=function(){return t.isOnline()?d[e]._findAll():d[e]._findAllLocal()},r._selectLocal=function(n){return n&&(n=n.replace(/^#+/,"")),new y(t,this||d[e],n,t.getLocalDatabase())},r._select=function(n){return n&&(n=n.replace(/^#+/,"")),new y(t,this||d[e],n)},r.select=function(n){return t.isOnline()?d[e]._select(n):d[e]._selectLocal(n)},r.prototype._insertLocal=function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r-0]=arguments[r];return this.set.apply(this,n),this.isNew()?d[e]._insertLocal(this.get()).then(function(){return t}):a.Promise.reject(new u.Error(-1,"object is created"))},r.prototype._insert=function(){for(var n=this,r=[],o=0;o<arguments.length;o++)r[o-0]=arguments[o];if(this.set.apply(this,r),!this.isNew())return a.Promise.reject(new u.Error(-1,"object is created"));var i=function(r,o){var i=d[e].formatColumns(n._columns,!0);t.getAjax().post("data/batch/addData").send({objectName:e,data:[i]}).end(s.Ajax.end(function(t){r(n.set(t.results[0]))},o))};return new a.Promise(i)},r.prototype.insert=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return t.isOnline()?this._insert.apply(this,e):this._insertLocal.apply(this,e)},r.prototype._updateLocal=function(){for(var n=this,r=[],o=0;o<arguments.length;o++)r[o-0]=arguments[o];if(this.isNew())return a.Promise.reject(new u.Error(-1,"object is not created"));this.set.apply(this,r);var i=d[e].formatColumns(this._columns,!1),s=(new p.default).translateUpdate(e,i.objectId,i);return new a.Promise(function(r,o){var u=t.getLocalDatabase();u.transaction(function(t){t.executeSql(s.query,s.params,function(){for(var n=[],r=0;r<arguments.length;r++)n[r-0]=arguments[r];var o="INSERT OR IGNORE INTO "+p.default.getQueueTableName(e)+" ( `type`, `id`, `serverUpdateTime` ) VALUES ( ?, ?, ? )",s=["updated",i.objectId,null];t.executeSql(o,s)})},function(t){o(t)},function(){r(n)})})},r.prototype._update=function(){for(var n=this,r=[],o=0;o<arguments.length;o++)r[o-0]=arguments[o];if(this.isNew())return a.Promise.reject(new u.Error(-1,"object is not created"));this.set.apply(this,r);var i=function(r,o){var i=d[e].formatColumns(n._columns,!1);t.getAjax().post("data/batch/updateData").send({objectName:e,data:[i]}).end(s.Ajax.end(function(t){n.set(t.results[0]),r(n)},o))};return new a.Promise(i)},r.prototype.update=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return t.isOnline()?this._update.apply(this,e):this._updateLocal.apply(this,e)},r.prototype._saveLocal=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return this.isNew()?this._insertLocal.apply(this,t):this._updateLocal.apply(this,t)},r.prototype._save=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return this.isNew()?this._insert.apply(this,t):this._update.apply(this,t)},r.prototype.save=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return t.isOnline()?this._save.apply(this,e):this._saveLocal.apply(this,e)},r.removeById=function(t){return d[e].findById(t).then(function(t){return t.remove()})},r.prototype._removeLocal=function(){var n=this;return new a.Promise(function(r,o){var i=t.getLocalDatabase();i.transaction(function(t){var r=(new p.default).translateDelete(e,n.get("objectId"));t.executeSql(r.query,r.params);var o="SELECT type FROM "+p.default.getQueueTableName(e)+" WHERE id = ?",i=[n.get("objectId")];t.executeSql(o,i,function(){for(var r=[],o=0;o<arguments.length;o++)r[o-0]=arguments[o];var i="INSERT OR REPLACE INTO "+p.default.getQueueTableName(e)+" ( `type`, `id`, `serverUpdateTime` ) VALUES ( ?, ?, ? )",s=["deleted",n.get("objectId"),n.get("serverUpdateTime")];r[1].rows.length>0&&"created"==r[1].rows.item(0).type&&(i="DELETE FROM "+p.default.getQueueTableName(e)+" WHERE id = ?",s=[n.get("objectId")]),t.executeSql(i,s)})},function(t){o(t)},function(){r(!0)})})},r.prototype._remove=function(){var n=this,r=function(r,o){t.getAjax().post("data/batch/deleteData").send({objectName:e,objectIds:[{objectId:n.get("objectId"),serverUpdateTime:n.get("serverUpdateTime")}]}).end(s.Ajax.end(r,o))};return new a.Promise(r)},r.prototype.remove=function(){return t.isOnline()?this._remove.apply(this):this._removeLocal.apply(this)},r.prototype.isNew=function(){return!this._columns.objectId},r.countUnsent=function(){return new a.Promise(function(n,r){var o=null,i=t.getLocalDatabase();i.transaction(function(t){t.executeSql("SELECT * FROM "+p.default.getQueueTableName(e),[],function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];o={created:0,updated:0,deleted:0};for(var n=0;n<t[1].rows.length;n++){var r=t[1].rows.item(n);o[r.type]++}})},function(t){r(t)},function(){n(o)})})},r.getUnsents=function(){return new a.Promise(function(n,r){var o={created:[],updated:[],deleted:[]},i=t.getLocalDatabase();i.transaction(function(t){t.executeSql("SELECT * FROM "+p.default.getQueueTableName(e),[],function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n=0;n<t[1].rows.length;n++){var r=t[1].rows.item(n);o[r.type].push({objectId:r.id,serverUpdateTime:r.serverUpdateTime})}})},function(t){r()},function(){n(o)})}).then(function(t){return a.Promise.all([d[e]._selectLocal().valuesIn("objectId",t.created.map(function(t){return t.objectId})).findList(),d[e]._selectLocal().valuesIn("objectId",t.updated.map(function(t){return t.objectId})).findList(),a.Promise.resolve(t.deleted)])}).then(function(t){return{created:t[0][e],updated:t[1][e],deleted:t[2]}})},r.downlink=function(n){if(!t.isOnline())throw"offline mode";if(t.isLocked(e))throw"now locking";return new g(t,this||d[e],n).setLocalDatabase(t.getLocalDatabase())},r.clearQueue=function(n){return new a.Promise(function(r,o){var i=t.getLocalDatabase();i.transaction(function(t){var r="DELETE FROM "+p.default.getQueueTableName(e)+" WHERE type = ?";t.executeSql(r,[n])},function(t){o(t)},function(){r()})})},r.uplink=function(n){if(!t.isOnline())throw"offline mode";if(t.isLocked(e))throw"now locking";n||(n=function(){});var r=null,o={update:[],delete:[]};return t.lock(e),d[e].getUnsents().then(function(t){return r=t,d[e]._insertAll(r.created)}).then(function(){return d[e].clearQueue("created")}).then(function(){return a.Promise.all(r.updated.map(function(t){return t.update().catch(function(e){return o.update.push(t),a.Promise.resolve()})}))}).then(function(){return d[e].clearQueue("updated")}).then(function(){return a.Promise.all(r.deleted.map(function(n){return new a.Promise(function(r,o){t.getAjax().post("data/batch/deleteData").send({objectName:e,objectIds:[{objectId:n.objectId,serverUpdateTime:n.serverUpdateTime}]}).end(s.Ajax.end(r,o))}).catch(function(t){return o.delete.push(n),a.Promise.resolve()})}))}).then(function(){return d[e].clearQueue("deleted")}).then(function(){t.unlock(e),(o.update&&0!=o.update.length||o.deleted&&0!=o.deleted.length)&&n(o)}).catch(function(n){return t.unlock(e),a.Promise.reject(n)})},r._debug=function(){var n=[];return new a.Promise(function(r,o){var i=t.getLocalDatabase();i.transaction(function(t){t.executeSql("SELECT * FROM "+e,[],function(){for(var r=[],o=0;o<arguments.length;o++)r[o-0]=arguments[o];for(var i=0;i<r[1].rows.length;i++)n.push(r[1].rows.item(i));t.executeSql("SELECT * FROM "+p.default.getQueueTableName(e),[],function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var r=0;r<t[1].rows.length;r++)n.push(t[1].rows.item(r))})})},function(t){o(t)},function(){r(n)})})},r.prototype.get=function(t){return t?this._columns[t]:this._columns},r.prototype.set=function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r-0]=arguments[r];var o={};return 1==n.length&&"object"==typeof n[0]?o=n[0]:o[n[0]]=n[1],this._columns=l({},this._columns,o),this._columns=d[e].sliceColumns(this._columns),this._columns=d[e].parseColumns(this._columns),Object.keys(this._columns).forEach(function(t){if(m.indexOf(t)!=-1)throw new u.Error(-1,"Invalid column name: "+t)}),Object.keys(this._columns).forEach(function(e){Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(t){this.set(e,t)},enumerable:!0,configurable:!0})}),this},r.sliceColumns=function(t){return d[e].noNeedColumns.forEach(function(e){delete t[e]}),t},r.parseColumns=function(t){var e={};return l(e,t),Object.keys(n).forEach(function(r){null!==t[r]&&void 0!==t[r]&&(n[r].type==i.DataType.Long||n[r].type==i.DataType.Integer?""===t[r]?e[r]=null:e[r]=parseInt(t[r]):n[r].type==i.DataType.Bool&&"boolean"!=typeof e[r]?""===t[r]?e[r]=null:e[r]=!!parseInt(t[r]):n[r].type!=i.DataType.DateTime||e[r]instanceof Date?n[r].type==i.DataType.Double&&(""===t[r]?e[r]=null:e[r]=parseFloat(t[r])):""===t[r]?e[r]=null:e[r]=new Date(parseInt(t[r])))}),e},r.formatColumns=function(t,r){var o={};return l(o,t),Object.keys(n).forEach(function(r){if(null!==t[r]&&void 0!==t[r])if(n[r].type==i.DataType.Bool)o[r]=t[r]?1:0;else if(n[r].type==i.DataType.DateTime){if(!(t[r]instanceof Date))throw new u.Error(-1,"invalid type: column "+e+'"."'+r+'"');o[r]=t[r].getTime()}else n[r].type==i.DataType.Double&&("number"==typeof t[r]?o[r]=t[r]+"":o[r]=parseFloat(t[r])+"")}),r&&(o.createTime=Date.now()/1e3),o.updateTime=Date.now()/1e3,d[e].filterDefinedColumnOnly(o)},r.filterDefinedColumnOnly=function(t){var e={};return Object.keys(n).forEach(function(n){e[n]=t[n]}),e.objectId=t.objectId,e.scopeType=t.scopeType||2,e.serverCreateTime=t.serverCreateTime,e.serverUpdateTime=t.serverUpdateTime,e.createTime=t.createTime,e.updateTime=t.updateTime,e},r._rawInsert=function(n){return new a.Promise(function(r,o){t.getAjax().post("data/batch/addData").send({objectName:e,data:n}).end(s.Ajax.end(r,o))})},r._normalizeColumns=function(t){var n,o,i=this;return t[0]instanceof r?(o=t,n=o.map(function(t){return t.get()})):(n=t,o=n.map(function(t){var n=new(i||d[e])(t);return n})),{columns:o.map(function(t){return d[e].formatColumns(t.get(),!0)}),models:o}},r.className=e,r.modelColumns=n,r.noNeedColumns=["groupIds"],r}(),d[e]}var r=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n;1==t.length&&t[0]instanceof Array?(this._query=t[0][0],n=t[0].slice(1)):(this._query=t[0],n=t.slice(1)),n instanceof Array?this._params=n:this._params=[n]}return t.prototype.getQuery=function(){var t={source:this._query};return this._params&&(t.params=this._params),t},t}();t.Expression=r,function(t){t[t.User=1]="User",t[t.Group=2]="Group",t[t.All=3]="All"}(t.ScopeType||(t.ScopeType={}));t.ScopeType;!function(t){t[t.LeftInner=1]="LeftInner",t[t.LeftOuter=2]="LeftOuter",t[t.RightOuter=3]="RightOuter",t[t.Inner=4]="Inner"}(t.JoinType||(t.JoinType={}));var f=t.JoinType;!function(t){t[t.asc=0]="asc",t[t.desc=1]="desc"}(t.Order||(t.Order={}));var h=t.Order,d={},m=["isNew","get","set","insert","update","save","remove"];t.define=n;var y=function(){function t(t,e,n,r){this._class=e,this._queryObj={from:{phyName:this._class.className}},this._appPot=t,this._localDB=r||!1,this._useLocal=!!r,this._ajax=t.getAjax(),n?this._queryObj.from.alias=n:this._queryObj.from.alias=this._class.className,this._keyClassMap={},this._keyClassMap[this._queryObj.from.alias]=this._class.className}return t.prototype.normalizeExpression=function(t){if(t.length>=2)return new r(t);if(t[0]instanceof r)return t[0];if("string"==typeof t[0])return new r(t[0]);throw"faild to normalize expression: "+JSON.stringify(t)},t.prototype.valuesIn=function(t,e){for(var n=this._queryObj.from.alias,r="#"+n+"."+t+" = ?",o=0;o<e.length-1;o++)r+=" or #"+n+"."+t+" = ?";var i=this.normalizeExpression([r].concat(e));return this._queryObj.where||(this._queryObj.where={}),this._queryObj.where.expression=i.getQuery(),this},t.prototype.where=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=this.normalizeExpression(t);return this._queryObj.where||(this._queryObj.where={}),this._queryObj.where.expression=n.getQuery(),this},t.prototype.join=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=f.LeftInner,o=t.className;if("number"==typeof e[0]&&(r=e.shift()),"object"==typeof e[0]){var i=e.shift();o=i.alias?i.alias:o,r=i.joinType?i.joinType:r}var s="LEFT JOIN";switch(r){case f.LeftOuter:s="LEFT OUTER JOIN";break;case f.LeftInner:s="LEFT JOIN";break;case f.RightOuter:s="RIGHT OUTER JOIN";break;case f.Inner:s="INNER JOIN"}var u=this.normalizeExpression(e);return this._queryObj.join||(this._queryObj.join=[]),this._queryObj.join.push({type:s,entity:t.className,entityAlias:o,expression:u.getQuery()}),this._keyClassMap[o]=t.className,this},t.prototype.orderBy=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this._queryObj.orderBy||(this._queryObj.orderBy=[]);var n={};return"string"==typeof t[0]&&(n.column=t[0],1==t.length?n.type="asc":"string"==typeof t[1]?n.type=t[1]:n.type=h[t[1]]),this._queryObj.orderBy.push(n),this},t.prototype.limit=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return this._queryObj.range={limit:t[0]||1e3,offset:1},2==t.length&&(this._queryObj.range.offset=t[1]+1),this},t.prototype.resetQuery=function(){return this._queryObj={},this},t.prototype.findOne=function(){var t=this;return this._queryObj.range=this._queryObj.range||{limit:1,offset:1},this._useLocal?this._queryToLocal().then(function(t){var e={};return Object.keys(t).forEach(function(n){e[n]=t[n][0]}),e}):this._post().then(function(n){var r={};return Object.keys(t._keyClassMap).forEach(function(o){var i=t._keyClassMap[o],s=!1;i==t._class.className&&(s=t._class),n[o]?r[o]=e(i,n[o][0],s):r[o]=e(i,n[i][0],s)}),r})},t.prototype.findList=function(){var t=this;return this._useLocal?this._queryToLocal():this._post().then(function(n){var r={};return Object.keys(t._keyClassMap).forEach(function(o){r[o]=[];var i=t._keyClassMap[o],s=!1;i==t._class.className&&(s=t._class);var u=n[o]?n[o]:n[i];u.forEach(function(t,n){r[o].push(e(i,t,s))})}),r})},t.prototype._queryToLocal=function(){var t=this;return new a.Promise(function(e,n){var r=(new p.default).translateSelect(t._queryObj,t._keyClassMap,d);t._localDB||n("Local Database is undefined");var o=[];t._localDB.transaction(function(t){t.executeSql(r.query,r.params,function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n=0;n<t[1].rows.length;n++)o.push(t[1].rows.item(n))})},function(t){n(t)},function(){e(o)})}).then(function(n){var r={};Object.keys(t._keyClassMap).forEach(function(t){r[t]=[]}),n.forEach(function(t,e){Object.keys(t).forEach(function(n){var o=n.match(/(.*)____(.*)/),i=o[1],s=o[2];r[i][e]||(r[i][e]={}),r[i][e][s]=t[n]})});var o={};return Object.keys(r).forEach(function(n){o[n]=r[n].map(function(r){return e(t._keyClassMap[n],r)})}),o})},t.prototype._post=function(){var t=this,e=function(e,n){t._ajax.post("data/query/"+t._class.className).send(t._queryObj).end(s.Ajax.end(e,function(r){if(r.response&&404==r.response.statusCode){var o=[t._class.className];t._queryObj.join instanceof Array&&t._queryObj.join.forEach(function(t){o.push(t.entity)});var i={};o.forEach(function(t){i[t]=[]}),e(i)}else n(r)}))};return new a.Promise(e)},t}(),g=function(t){function e(){t.apply(this,arguments)}return o(e,t),e.prototype.findOne=function(){return a.Promise.reject('Cannot use "findOne" method to downlink. Please use "execute" method.')},e.prototype.findList=function(){return a.Promise.reject('Cannot use "findList" method to downlink. Please use "execute" method.')},e.prototype.setLocalDatabase=function(t){return this._localDB=t,this},e.prototype.execute=function(){var e=this,n=function(t){return function(n,r){e._localDB.transaction(function(n){var r=e._class.className,o=d[r]._getColumnsPlaceholders(),i=o.colNames,s=o.placeholders,u=i.map(function(t){return"`"+t+"`"}),a=c.Database.getSqliteTableDefinition(e._class);a.forEach(function(t){n.executeSql(t)}),n.executeSql("DELETE FROM "+r),n.executeSql("DELETE FROM "+p.default.getQueueTableName(r));var l="INSERT INTO "+r+" ("+u.join(",")+") VALUES ("+s.join(",")+");";t[r].forEach(function(t){var e=i.map(function(e){return t.get(e)});n.executeSql(l,e)})},function(t){e._appPot.unlock(e._class.className),r(t)},function(){e._appPot.unlock(e._class.className),n()})}};return this._appPot.lock(this._class.className),t.prototype.findList.call(this).then(function(t){return new a.Promise(n(t))})},e}(y)}(r=e.Model||(e.Model={}))},function(t,e){"use strict";var n=function(){function t(){this._params=[]}return t.getQueueTableName=function(t){return"apppot_"+t+"_queue"},t.prototype.translateDelete=function(t,e){return{query:"DELETE FROM "+t+" WHERE objectId = ?",params:[e]}},t.prototype.translateUpdate=function(t,e,n){var r=[],o=Object.keys(n).map(function(t){return r.push(n[t]),"`"+t+"` = ?"});return r.push(e),{query:"UPDATE "+t+" SET "+o.join(",")+" WHERE objectId = ?",params:r}},t.prototype.translateSelect=function(t,e,n){this._keyClassMap=e,this._classList=n;var r=this.selectFromJoin(t)+" "+this.where(t)+" "+this.order(t)+" "+this.limit(t);return{query:r,params:this._params}},t.prototype.getClass=function(t){return this._classList[this._keyClassMap[t]]},t.prototype.expression=function(t,e){return this._params=this._params.concat(e),t.replace(/#/g,"")},t.prototype.limit=function(t){if(!t.range)return"";var e=t.range;return"LIMIT "+e.limit+" OFFSET "+(e.offset-1)},t.prototype.order=function(t){if(!t.orderBy||0==t.orderBy.length)return"";var e=t.orderBy;return"order by "+e.map(function(t){return t.column+" "+t.type}).join(",")},t.prototype.where=function(t){if(t.where&&t.where.expression){var e=t.where.expression;return"WHERE "+this.expression(e.source,e.params)}return""},t.prototype.selectFromJoin=function(t){var e=this,n=t.from.alias,r=this.getClass(n),o=Object.keys(r.modelColumns).map(function(t){return"`"+n+"`.`"+t+"` AS "+n+"____"+t});o.push("`"+n+"`.`objectId` AS "+n+"____objectId"),o.push("`"+n+"`.`serverCreateTime` AS "+n+"____serverCreateTime"),o.push("`"+n+"`.`serverUpdateTime` AS "+n+"____serverUpdateTime");var i="FROM "+t.from.phyName;return t.from.phyName!=t.from.alias&&(i+=" AS "+t.from.alias),t.join&&t.join.length>0&&t.join.forEach(function(t){var n=t.entityAlias;i+=" "+t.type+" "+t.entity,t.entity!=n&&(i+=" AS "+n);var r=e.expression(t.expression.source,t.expression.params);i+=" ON "+r+" ";var s=Object.keys(e.getClass(n).modelColumns).map(function(t){return"`"+n+"`.`"+t+"` AS "+n+"____"+t});s.push("`"+n+"`.`objectId` AS "+n+"____objectId"),o=o.concat(s)}),"SELECT "+o.join(",")+" "+i},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e){"use strict";var n=function(){function t(t){var e=this;this._columns={udid:"",name:"",osType:"",token:""},Object.keys(this._columns).forEach(function(n){t[n]&&(e._columns[n]=t[n])})}return Object.defineProperty(t.prototype,"udid",{
get:function(){return this._columns.udid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"token",{get:function(){return this._columns.token},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._columns.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"osType",{get:function(){return this._columns.osType},enumerable:!0,configurable:!0}),t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,n){"use strict";function r(t){return function(){function e(t){this._columns={account:"",firstName:"",lastName:"",password:"",userId:null},this.set(t)}return e.prototype.set=function(t){var e=this;Object.keys(this._columns).forEach(function(n){t[n]&&(e._columns[n]=t[n])});var n=t.groupsRoles||t.groupsAndRoles||t.groupRoleMap||this.groupsRoles;if(n instanceof u)n=[n];else if(!(n instanceof Array))throw"Invalid arguments groupsRoles";return this._columns.groupsRoles=n.map(function(t){return new u(t)}),this},Object.defineProperty(e.prototype,"account",{get:function(){return this._columns.account},set:function(t){this._columns.account=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstName",{get:function(){return this._columns.firstName},set:function(t){this._columns.firstName=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastName",{get:function(){return this._columns.lastName},set:function(t){this._columns.lastName=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this._columns.userId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"password",{get:function(){return this._columns.password},set:function(t){this._columns.password=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupsRoles",{get:function(){return this._columns.groupsRoles},set:function(t){if(!(t instanceof u))throw"arguments is invalid type of class";this._columns.groupsRoles=t},enumerable:!0,configurable:!0}),e._isNumber=function(t){return("number"==typeof t||"string"==typeof t)&&(t==parseFloat(t)&&isFinite(t))},e.findById=function(n,r){return this._isNumber(n)?new i.Promise(function(i,s){t.getAjax().get("users/"+n,r).query({token:t.getAuthInfo().getToken()}).end(o.Ajax.end(function(t){i(new e(t.user))},s))}):i.Promise.reject("userId is not a number")},e.list=function(n,r){var s={};return this._isNumber(n)?s.groupId=n:s=n,new i.Promise(function(n,i){t.getAjax().get("users",r).query({token:t.getAuthInfo().getToken()}).query(s).end(o.Ajax.end(function(t){var r=t.users,o=r.map(function(t){return new e(t)});n(o)},i))})},e.prototype._getObjForUserAPI=function(){return{account:this.account,firstName:this.firstName,lastName:this.lastName,password:this.password,groupRoleMap:this.groupsRoles.map(function(t){return t.getGroupsRolesForUserAPI()})}},e.prototype.create=function(e){var n=this;return new i.Promise(function(r,i){var s=n._getObjForUserAPI();t.getAjax().post("users",e).send(s).end(o.Ajax.end(function(t){r(n.set(t.user))},i))})},e.prototype.update=function(e,n){var r=this;return e&&this.set(e),new i.Promise(function(e,i){var s=r._getObjForUserAPI();t.getAjax().put("users/"+r.userId,n).send(s).end(o.Ajax.end(function(t){e(r.set(t.user))},i))})},e.prototype.remove=function(t){return e.remove(this.userId,t)},e.remove=function(e,n){return new i.Promise(function(r,i){t.getAjax().remove("users/"+e,n).query({token:t.getAuthInfo().getToken()}).end(o.Ajax.end(r,i))})},e}()}var o=n(4),i=n(13);e.getUserClass=r,function(t){t[t.SuperAdmin=2]="SuperAdmin",t[t.Admin=3]="Admin",t[t.Manager=4]="Manager",t[t.User=5]="User"}(e.Role||(e.Role={}));var s=e.Role,u=function(){function t(e){return e instanceof t?e:e._groupId&&e._groupName&&e._roleName?(this._groupId=e._groupId,this._groupName=e._groupName,this._roleName=e._roleName,this):(e.group&&e.role&&(this._groupId=e.group.groupId,this._roleName=e.role.roleName,this._groupName=e.group.groupName),e.groupId&&(this._groupId=e.groupId),e.roleName&&!this._roleName&&(this._roleName=e.roleName),e.role&&!this._roleName&&(this._roleName=s[e.role],"SuperAdmin"==this._roleName&&(this._roleName="Super Admin")),e.groupName&&(this._groupName=e.groupName),void(e.description&&(this._description=e.description)))}return t.prototype.setGroupsRoles=function(t){return this._groupId=t.group.groupId,this._roleName=t.role.roleName,this},Object.defineProperty(t.prototype,"groupId",{get:function(){return this._groupId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupName",{get:function(){return this._groupName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"role",{get:function(){var t=this._roleName;return"Super Admin"==t&&(t="SuperAdmin"),s[t]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleName",{get:function(){return this._roleName},enumerable:!0,configurable:!0}),t.prototype.getGroupsRolesForUserAPI=function(){return{group:{groupId:this.groupId},role:{roleName:this.roleName}}},t}();e.GroupsRoles=u},function(t,e,n){"use strict";function r(t){return function(){function e(t){this._columns={groupId:null,groupName:"",isAddCurrentApp:!1,description:""},this.set(t)}return Object.defineProperty(e.prototype,"groupId",{get:function(){return this._columns.groupId},set:function(t){this._columns.groupId=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupName",{get:function(){return this._columns.groupName},set:function(t){this._columns.groupName=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._columns.description},set:function(t){this._columns.description=t},enumerable:!0,configurable:!0}),e.prototype.set=function(t){var e=this;return Object.keys(this._columns).forEach(function(n){t[n]&&(e._columns[n]=t[n])}),this},e.list=function(n){return new i.Promise(function(r,i){t.getAjax().get("groups",n).query({token:t.getAuthInfo().getToken()}).end(o.Ajax.end(function(t){var n=t.groups.map(function(t){return new e(t)});r(n)},i))})},e.prototype.create=function(e,n){var r=this;return new i.Promise(function(e,i){t.getAjax().post("groups",n).send(r._columns).end(o.Ajax.end(function(t){e(r.set(t.group))},i))})},e.prototype.update=function(e,n){var r=this;return e&&this.set(e),new i.Promise(function(e,i){t.getAjax().update("groups/"+r.groupId,n).send(r._columns).end(o.Ajax.end(function(t){e(r.set(t.group))},i))})},e.prototype.remove=function(t){return e.remove(this.groupId,t)},e.remove=function(e,n){return new i.Promise(function(r,i){t.getAjax().remove("groups/"+e,n).query({token:t.getAuthInfo().getToken()}).end(o.Ajax.end(r,i))})},e}()}var o=n(4),i=n(13);e.getGroupClass=r},function(t,e,n){"use strict";function r(t){return function(){function e(t,e){this._name=t,this._url=e}return e.getUrl=function(e){return t.getConfig().entryPoint+"files/"+e+"?userToken="+t.getAuthInfo().getToken()},Object.defineProperty(e.prototype,"url",{get:function(){return t.getConfig().entryPoint+"files/"+this.name+"?userToken="+t.getAuthInfo().getToken()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e.create=function(n,r,s){var u=s?s:function(){},a=JSON.stringify({name:n});return new i.Promise(function(n,i){t.getAjax().post("files",{contentType:"no-set"}).field("entity",a).attach("file",r).on("progress",u).end(o.Ajax.end(function(t){var r=new e(t.results.name,t.results.url);n(r)},i))})},e.prototype.get=function(t){return e.get(this.name,t)},e.get=function(e,n){var r=n?n:function(){};return new i.Promise(function(n,i){t.getAjax().get("files/"+e).query("userToken="+t.getAuthInfo().getToken()).on("progress",r).end(o.Ajax.end(function(t){n(t)},i))})},e.prototype.update=function(n,r,s){var u=this,a=s?s:function(){},c=JSON.stringify({name:n});return new i.Promise(function(n,i){t.getAjax().put("files/"+u.name,{contentType:"no-set"}).field("entity",c).attach("file",r).on("progress",a).end(o.Ajax.end(function(t){var r=new e(t.results.name,t.results.url);n(r)},i))})},e.prototype.remove=function(e){var n=this;return new i.Promise(function(e,r){t.getAjax().remove("files/"+n.name).end(o.Ajax.end(function(t){e(t)},r))})},e}()}var o=n(4),i=n(13);e.getFileClass=r},function(t,e,n){"use strict";function r(t,e,n,r,o,s){var u="json",a=!1;s&&s.original&&(u="original",a=!0);var c=r?r:{},p=o?o:[];p instanceof Array||(p=[p]);var l=n.replace(/^\//,"").replace(/\/$/,"");return new i.Promise(function(n,r){t("gateway/"+e+"/"+u+"/"+l).query(c).send(p).end(function(t,e){if(a)return n({error:t,response:e});if(t)return r({status:"error",results:t,response:e});var o=JSON.parse(e.text);return"OK"!=o.status?r({status:"error",results:t,response:e}):void n(o.results)})})}function o(t){return new s(t)}var i=n(13),s=function(){function t(t){this._ajax=t.getAjax()}return t.prototype.get=function(t,e,n,o,i){return r(this._ajax.get.bind(this._ajax),t,e,n,o,i)},t.prototype.post=function(t,e,n,o,i){return r(this._ajax.post.bind(this._ajax),t,e,n,o,i)},t.prototype.put=function(t,e,n,o,i){return r(this._ajax.put.bind(this._ajax),t,e,n,o,i)},t.prototype.remove=function(t,e,n,o,i){return r(this._ajax.remove.bind(this._ajax),t,e,n,o,i)},t}();e.getGateway=o}])});